(function(){function B(n){(function(a){function n(){a("object.cgmp-json-string-placeholder").each(function(d,g){var h=a(g).attr("id"),h=a(g).find("param#json-string-"+h).val(),h=x.searchReplace(h,"'",""),h=h.replace("&quot;",""),b=L(h);if("undefined"===typeof b||!b)return e.fatal("We did not parse JSON from OBJECT param. Aborting map generation .."),!1;if(0<a("div#"+b.id).length){var M=new google.maps.Map(document.getElementById(b.id));w.initMap(M,b.bubbleautopan,parseInt(b.zoom),b.maptype);y.init(M);
    h=new B;h.init(M,b.bubbleautopan,b.distanceunits,b);h.setGeoLocationIfEnabled(b.enablegeolocationmarker);w.setMapControls({mapTypeControl:"true"===b.maptypecontrol,panControl:"true"===b.pancontrol,zoomControl:"true"===b.zoomcontrol,scaleControl:"true"===b.scalecontrol,scrollwheel:"true"===b.scrollwheelcontrol,streetViewControl:"true"===b.streetviewcontrol,tilt:"true"===b.tiltfourtyfive?45:null,draggable:"true"===b.draggable,overviewMapControl:!0,overviewMapControlOptions:{opened:!1}});"true"===b.showpanoramio&&
    y.buildPanoramioLayer(b.panoramiouid);"true"===b.showbike&&y.buildBikeLayer();"true"===b.showtraffic&&y.buildTrafficLayer();null!=b.kml&&""!=x.trim(b.kml)?y.buildKmlLayer(b.kml):(null!=b.markerlist&&""!=x.trim(b.markerlist)&&h.buildAddressMarkers(b.markerlist,b.addmarkermashup,b.addmarkermashupbubble),h.isBuildAddressMarkersCalled()||C.alertError(CGMPGlobal.msgMissingMarkers));a(document).ready(function(){function g(){null!=h&&clearTimeout(h);h=a(r).is(":hidden")?setTimeout(g,n):setTimeout(function(){d(M)},
        n)}function d(a){null!=h&&clearTimeout(h);a&&(google.maps.event.trigger(a,"resize"),h=setTimeout(function(){null!=h&&clearTimeout(h);a&&google.maps.event.trigger(a,"click")},n/2))}var h=null,n=500,r="div#"+b.id;a(r).is(":hidden")?(e.warn("Map placeholder DIV is hidden, must resize the map!"),g()):h=setTimeout(function(){g()},3*n)})}else e.fatal("It looks like the map DIV placeholder ID ["+b.id+"] does not exist in the page!")})}var L=function(a){},t=parseFloat(a.fn.jquery.split(".")[0]),r=parseFloat(a.fn.jquery.split(".")[1]);
    1<=t&&2>t&&4<=r?L=a.parseJSON:window.JSON&&window.JSON.parse?L=window.JSON.parse:e.fatal("Using parseJson stub..");var w=function(){var a={};return{initMap:function(g,h,b,e){a=g;g=[];for(var n in google.maps.MapTypeId)g.push(google.maps.MapTypeId[n]);"OSM"==e?(g.push(e),a.mapTypes.set(e,new google.maps.ImageMapType({getTileUrl:function(a,e){return"http://tile.openstreetmap.org/"+e+"/"+a.x+"/"+a.y+".png"},tileSize:new google.maps.Size(256,256),name:"OpenStreet",maxZoom:20}))):"ROADMAP"==e?e=google.maps.MapTypeId.ROADMAP:
        "SATELLITE"==e?e=google.maps.MapTypeId.SATELLITE:"HYBRID"==e?e=google.maps.MapTypeId.HYBRID:"TERRAIN"==e&&(e=google.maps.MapTypeId.TERRAIN);a.setOptions({zoom:b,mapTypeId:e,mapTypeControlOptions:{mapTypeIds:g}})},setMapControls:function(e){a.setOptions(e)}}}(),y=function(){var a={};return{init:function(e){a=e},buildKmlLayer:function(g){if(0>g.toLowerCase().indexOf("http"))return e.error("KML URL must start with HTTP(S). Aborting.."),!1;var h=new google.maps.KmlLayer(g);google.maps.event.addListener(h,
        "status_changed",function(){var a=h.getStatus();if(a!=google.maps.KmlLayerStatus.OK){var g="";switch(a){case google.maps.KmlLayerStatus.DOCUMENT_NOT_FOUND:g=CGMPGlobal.kmlNotFound;break;case google.maps.KmlLayerStatus.DOCUMENT_TOO_LARGE:g=CGMPGlobal.kmlTooLarge;break;case google.maps.KmlLayerStatus.FETCH_ERROR:g=CGMPGlobal.kmlFetchError;break;case google.maps.KmlLayerStatus.INVALID_DOCUMENT:g=CGMPGlobal.kmlDocInvalid;break;case google.maps.KmlLayerStatus.INVALID_REQUEST:g=CGMPGlobal.kmlRequestInvalid;
            break;case google.maps.KmlLayerStatus.LIMITS_EXCEEDED:g=CGMPGlobal.kmlLimits;break;case google.maps.KmlLayerStatus.TIMED_OUT:g=CGMPGlobal.kmlTimedOut;break;case google.maps.KmlLayerStatus.UNKNOWN:g=CGMPGlobal.kmlUnknown}if(""!=g){var d=CGMPGlobal.kml.replace("[MSG]",g),d=d.replace("[STATUS]",a);C.alertError(d);e.error("Google returned KML error: "+g+" ("+a+")");e.error("KML file: "+h.getUrl())}}});google.maps.event.addListener(h,"defaultviewport_changed",function(){});h.setMap(a)},buildTrafficLayer:function(){(new google.maps.TrafficLayer).setMap(a)},
        buildBikeLayer:function(){(new google.maps.BicyclingLayer).setMap(a)},buildPanoramioLayer:function(g){if("undefined"===typeof google.maps.panoramio||!google.maps.panoramio||null==google.maps.panoramio)return e.error("We cannot access Panoramio library. Aborting.."),!1;var h=new google.maps.panoramio.PanoramioLayer;h?(null!=g&&""!=g&&h.setUserId(g),h.setMap(a)):e.error("Could not instantiate Panoramio object. Aborting..")}}}(),B=function(){function d(){clearTimeout(H);if(0<D.length){var f=D.shift();
        e.info("Geocoding '"+f.address+"' Left "+D.length+" items to geocode..");U.geocode({address:f.address},function(a,c){g(a,c,f)})}else{O();if(Q){e.warn("Reset server map data cache required");if(V){a.each(u,function(f,c){var k=(c.position+"").replace(RegExp("\\(|\\)","g"),"");a.each(R,function(a,f){if(a===c.content&&-1!=f.validated_address_csv_data.indexOf(CGMPGlobal.geoValidationClientRevalidate))return f.validated_address_csv_data=f.validated_address_csv_data.replace(RegExp(CGMPGlobal.geoValidationClientRevalidate,
        "g"),k),!1})});var c=JSON.stringify(R);a.post(CGMPGlobal.ajaxurl,{action:CGMPGlobal.ajaxCacheMapAction,data:c,geoMashup:"true",timestamp:CGMPGlobal.timestamp},function(a){e.info("Posting map data to the server..");null!=a&&"OK"===a&&e.info("Map geo mashup cache was reset on the server")})}else{var k=E.markerlist.split("|"),q=E.debug.widget_id,b=E.debug.post_id,h=E.debug.post_type,d=E.debug.shortcodeid,l=[];a.each(u,function(f,c){var q=(c.position+"").replace(RegExp("\\(|\\)","g"),"");a.each(k,function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   k){var b=k.split(CGMPGlobal.sep);if(b[0]===c.content)return e.info(b[0]+" matched "+c.content+" (marker#"+(f+1)+")"),-1!=k.indexOf(CGMPGlobal.geoValidationClientRevalidate)?l[f]=k.replace(RegExp(CGMPGlobal.geoValidationClientRevalidate,"g"),q):l[f]=k,!1})});c=l.join("|");"undefined"!==typeof q&&"undefined"!==q?a.post(CGMPGlobal.ajaxurl,{action:CGMPGlobal.ajaxCacheMapAction,data:c,geoMashup:"false",widgetId:q,timestamp:CGMPGlobal.timestamp},function(a){e.info("Posting map data to the server..");null!=
        a&&"OK_WIDGET"===a&&e.info("Map cache was reset on the server for widget#"+q)}):"undefined"!==typeof b&&"undefined"!==b&&a.post(CGMPGlobal.ajaxurl,{action:CGMPGlobal.ajaxCacheMapAction,data:c,geoMashup:"false",postId:b,postType:h,shortcodeId:d,timestamp:CGMPGlobal.timestamp},function(a){e.info("Posting map data to the server..");null!=a&&("OK_POST"===a?e.info("Map cache was reset on the server for post#"+b+" shortcode#"+d):"OK_PAGE"===a?e.info("Map cache was reset on the server for page#"+b+" shortcode#"+
        d):"OK_CUSTOM"===a&&e.info("Map cache was reset on the server for type "+h+"#"+b+" shortcode#"+d))})}Q=!1}e.info("Have "+u.length+" markers on the map")}}function g(a,c,k){c==google.maps.GeocoderStatus.OK?(e.info("Geocoding '"+k.address+"' OK!"),n(a[0].geometry.location,k),H=setTimeout(function(){d()},300)):c==google.maps.GeocoderStatus.OVER_QUERY_LIMIT?(O(),D.push(k),H=setTimeout(function(){d()},3E3)):c==google.maps.GeocoderStatus.ZERO_RESULTS&&(e.warn("Got ZERO_RESULTS for ["+k.address+"]"),H=setTimeout(function(){d()},
        300))}function h(f,c){var k=1;R=f;a.each(f,function(a,f){if("live_debug"===a||"debug"===a)return!0;null==this.excerpt&&(this.excerpt="");"undefined"!==typeof this.validated_address_csv_data&&""!==this.validated_address_csv_data||e.error("Validated address from: "+this.permalink+" returned empty, perhaps OVER_QUERY_LIMIT when validating on the server..");b(this.validated_address_csv_data,this.title,this.permalink,this.excerpt,c,!0);k++})}function b(a,c,k,q,b,g){if("undefined"===typeof a||""===a)e.fatal("Not parsing empty validated address csv data.. Skipping");
    else{e.info("Raw: "+a);a=a.split("|");for(var h=0;h<a.length;h++){var d=a[h];if(null!=d&&""!=d){var d=d.split(CGMPGlobal.sep),l=d[0],m=d[1],p=d[2],d=d[3];-1!=p.indexOf(CGMPGlobal.noBubbleDescriptionProvided)&&(p="");l={address:l,animation:google.maps.Animation.DROP,zIndex:h+1,markerIcon:m,customBubbleText:p,markerHoverText:p+" ("+l+")",postTitle:c,postLink:k,postExcerpt:q,infoBubbleContainPostLink:b,geoMashup:g};if(d===CGMPGlobal.geoValidationClientRevalidate)Q=!0,D.push(l);else{m=[];-1!=d.indexOf(",")?
        m=d.split(","):-1!=d.indexOf(";")&&(m=d.split(";"));m[0]=x.trim(m[0]);m[1]=x.trim(m[1]);if(""===m[0]||""===m[1])return e.warn("Lat or Long are empty string"),!1;d=new google.maps.LatLng(parseFloat(m[0]),parseFloat(m[1]));n(d,l)}}}}}function n(a,c){var k=new google.maps.Marker({position:a,title:c.markerHoverText,content:c.address,zIndex:c.zIndex+1E3,map:p});if(k){e.info("Built marker: "+c.address+" "+a);if(c.markerIcon){var q=c.markerIcon;if("undefined"==typeof q||"undefined"===q)q="1-default.png";
        k.setIcon(CGMPGlobal.customMarkersUri+q)}t(k,c);S||(B(),S=!0);u.push(k)}}function O(){var f=!1,c=null==s?!1:!0;1<u.length?(a.each(u,function(a,f){v.contains(f.position)||v.extend(f.position)}),f=!0):1==u.length&&(c?(v.extend(u[0].position),f=!0):(p.setCenter(u[0].position),N=p.getZoom(),I=p.getCenter()));f&&(c&&null!=s.getPosition()&&(e.info("Extended bounds with Geo marker position: "+s.getPosition()),v.extend(s.getPosition())),z=v,null!=v&&p.fitBounds(v))}function r(){null!=z?p.getCenter()!=z.getCenter()&&
        (e.info("Panning map back to its original bounds center: "+z.getCenter()),p.fitBounds(z),p.setCenter(z.getCenter())):null!=I&&(e.info("Panning map back to its original center: "+I+" and updated zoom: "+N),p.setCenter(I),p.setZoom(N))}function P(f){a(f+" input#a_address").val("");a(f+" input#b_address").val("");a(f+" input#a_address").removeClass("d_error");a(f+" input#b_address").removeClass("d_error");a("input#"+l+"_avoid_hway").prop("checked",!1);a("input#"+l+"_avoid_tolls").prop("checked",!1);
        a("input#"+l+"_radio_km").prop("checked",!1);a("input#"+l+"_radio_miles").prop("checked",!0)}function t(f,c){var k=C(f.content,c),q="div#direction-controls-placeholder-"+l,e=a("div#rendered-directions-placeholder-"+l);google.maps.event.addListener(f,"click",function(){P(q);a(q).fadeOut();F.setMap(null);e.html("");e.hide();a(q+" button#print_sub").hide();y(f,k,q);w(f,k,q,e);A.setContent(k.bubbleContent);A.setOptions({disableAutoPan:"true"===K?!1:!0});A.open(p,this)})}function w(f,c,k,e){var b="div#bubble-"+
        c.bubbleHolderId,d=f.content,d=d.replace("Lat/Long: ",""),g=!1==(null==s?!1:!0)||null==s.getPosition()?"":s.getPosition();a(document).on("click",b+" a.dirToHereTrigger",function(){this.id==="toHere-"+c.bubbleHolderId&&(a(k).fadeIn(),a(k+" input#a_address").val(g),a(k+" input#b_address").val(d),"miles"===J?(a("input#"+l+"_radio_miles").prop("checked",!0),a("input#"+l+"_radio_km").prop("checked",!1)):"km"===J&&(a("input#"+l+"_radio_km").prop("checked",!0),a("input#"+l+"_radio_miles").prop("checked",
        !1)))});a(document).on("click",b+" a.dirFromHereTrigger",function(){this.id==="fromHere-"+c.bubbleHolderId&&(a(k).fadeIn(),a(k+" input#a_address").val(d),a(k+" input#b_address").val(g),"miles"===J?(a("input#"+l+"_radio_miles").prop("checked",!0),a("input#"+l+"_radio_km").prop("checked",!1)):"km"===J&&(a("input#"+l+"_radio_km").prop("checked",!0),a("input#"+l+"_radio_miles").prop("checked",!1)))});a(document).on("click",k+" div.d_close-wrapper",function(f){P(k);a(this).parent().fadeOut();F.setMap(null);
        e.html("");e.hide();a(k+" button#print_sub").hide();r();return!1})}function y(f,c,k){W.getPanoramaByLocation(f.position,50,function(b,d){if(d===google.maps.StreetViewStatus.OK)a(document).on("click","a#trigger-"+c.bubbleHolderId,function(){var e={navigationControl:!0,enableCloseButton:!0,addressControl:!1,linksControl:!0,scrollwheel:!1,addressControlOptions:{position:google.maps.ControlPosition.BOTTOM},position:f.position,pov:{heading:165,pitch:0,zoom:1}},d=new google.maps.StreetViewPanorama(document.getElementById("bubble-"+
        c.bubbleHolderId),e);d.setVisible(!0);google.maps.event.addListener(A,"closeclick",function(){P(k);a(k).fadeOut();null!=d&&(d.unbind("position"),d.setVisible(!1));d=null});google.maps.event.addListener(d,"closeclick",function(){null!=d&&(d.unbind("position"),d.setVisible(!1),a("div#bubble-"+c.bubbleHolderId).css("background","none"));d=null})});else e.warn("There is not street view available for this marker location: "+f.position+" status: "+d),a(document).on("click","a#trigger-"+c.bubbleHolderId,
        function(a){a.preventDefault()}),a("a#trigger-"+c.bubbleHolderId).attr("style","text-decoration: none !important; color: #ddd !important"),google.maps.event.addListener(A,"domready",function(){a("a#trigger-"+c.bubbleHolderId).removeAttr("href");a("a#trigger-"+c.bubbleHolderId).attr("style","text-decoration: none !important; color: #ddd !important")})})}function B(){var f="div#direction-controls-placeholder-"+l,c=a("div#rendered-directions-placeholder-"+l);a(document).on("click",f+" a#reverse-btn",
        function(c){c=a(f+" input#a_address").val();var d=a(f+" input#b_address").val();a(f+" input#a_address").val(d);a(f+" input#b_address").val(c);return!1});a(document).on("click",f+" a#d_options_show",function(){a(f+" a#d_options_hide").show();a(f+" a#d_options_show").hide();a(f+" div#d_options").show();return!1});a(document).on("click",f+" a#d_options_hide",function(){a(f+" a#d_options_hide").hide();a(f+" a#d_options_show").show();a(f+" div#d_options").hide();a("input#"+l+"_avoid_hway").prop("checked",
        !1);a("input#"+l+"_avoid_tolls").prop("checked",!1);a("input#"+l+"_radio_km").prop("checked",!1);a("input#"+l+"_radio_miles").prop("checked",!0);return!1});a(document).on("click",f+" button#d_sub",function(){var k=a(f+" input#a_address").val(),d=a(f+" input#b_address").val(),b=!1;if(null==k||""==k)a(f+" input#a_address").addClass("d_error"),b=!0;if(null==d||""==d)a(f+" input#b_address").addClass("d_error"),b=!0;if(!b){a(f+" button#d_sub").prop("disabled",!0).html("Please wait..");var g=google.maps.DirectionsTravelMode.DRIVING;
        a(f+" a#dir_w_btn").hasClass("selected")&&(g=google.maps.DirectionsTravelMode.WALKING);var b=a("input#"+l+"_avoid_hway").is(":checked"),h=a("input#"+l+"_avoid_tolls").is(":checked"),m=a("input#"+l+"_radio_miles").is(":checked"),g={origin:k,destination:d,travelMode:g,provideRouteAlternatives:!0};b&&(g.avoidHighways=!0);h&&(g.avoidTolls=!0);g.unitSystem=m?google.maps.DirectionsUnitSystem.IMPERIAL:google.maps.DirectionsUnitSystem.METRIC;X.route(g,function(b,g){g==google.maps.DirectionsStatus.OK?(c.html(""),
            c.show(),F.setMap(p),F.setDirections(b),a(f+" button#d_sub").removeAttr("disabled").html("Get directions"),a(f+" button#print_sub").fadeIn(),A.close()):(e.error('Could not route directions from "'+k+'" to "'+d+'", got result from Google: '+g),c.html("<span style='font-size: 12px; font-weight: bold; color: red'>Could not route directions from<br />'"+k+"' to<br />'"+d+"'<br />Got result from Google: ["+g+"]</span>"),a(f+" button#print_sub").hide(),a(f+" button#d_sub").removeAttr("disabled").html("Get directions"))})}});
        a(document).on("click",f+" button#print_sub",function(){var c=a(f+" input#a_address").val(),d=a(f+" input#b_address").val(),b="d";a(f+" a#dir_w_btn").hasClass("selected")&&(b="w");c="http://maps.google.com/?saddr="+c+"&daddr="+d+"&dirflg="+b+"&pw=2";c=a("input#"+l+"_radio_miles").is(":checked")?c+"&doflg=ptm":c+"&doflg=ptk";"d"===b&&(b=a("input#"+l+"_avoid_hway").is(":checked"),d=a("input#"+l+"_avoid_tolls").is(":checked"),b&&(c+="&dirflg=h"),d&&(c+="&dirflg=t"));window.open(c);return!1});a(document).on("change focus",
            f+" input#a_address",function(){a(f+" input#a_address").removeClass("d_error");return!1});a(document).on("change focus",f+" input#b_address",function(){a(f+" input#b_address").removeClass("d_error");return!1});a(document).on("click",f+" .kd-button",function(){var c=this.id;"dir_d_btn"==c?a(f+" a#dir_d_btn").hasClass("selected")?e.warn("Driving travel mode is already selected"):(a(f+" a#dir_d_btn").addClass("selected"),a(f+" a#dir_w_btn").removeClass("selected")):"dir_w_btn"==c&&(a(f+" a#dir_w_btn").hasClass("selected")?
            e.warn("Walking travel mode is already selected"):(a(f+" a#dir_w_btn").addClass("selected"),a(f+" a#dir_d_btn").removeClass("selected")));return!1})}function C(a,c){var d=Math.floor(111111*Math.random()),d=d+"-"+l,b="<div id='bubble-"+d+"' style='height: 130px !important; width: 300px !important;' class='bubble-content'>";if(!c.geoMashup||c.geoMashup&&!c.infoBubbleContainPostLink)b+="<h4>"+CGMPGlobal.address+":</h4>",b+="<p class='custom-bubble-text'>"+a+"</p>",""!=c.customBubbleText&&(b+="<p class='custom-bubble-text'>"+
        c.customBubbleText+"</p>");else var g=c.postTitle.substring(0,30),b=b+""+("<p class='geo-mashup-post-title'><a title='Original post: "+c.postTitle+"' href='"+c.postLink+"'>"+g+"..</a></p>"),b=b+("<p class='geo-mashup-post-excerpt'>"+c.postExcerpt+"</p>");b+="<div class='custom-bubble-links-section'>";b+="<hr />";b+="<p class='custom-bubble-text'>"+CGMPGlobal.directions+": <a id='toHere-"+d+"' class='dirToHereTrigger' href='javascript:void(0);'>"+CGMPGlobal.toHere+"</a> - <a id='fromHere-"+d+"' class='dirFromHereTrigger' href='javascript:void(0);'>"+
        CGMPGlobal.fromHere+"</a> | <a id='trigger-"+d+"' class='streetViewTrigger' href='javascript:void(0);'>"+CGMPGlobal.streetView+"</a></p>";b+="</div></div>";return{bubbleHolderId:d,bubbleContent:b}}function m(a,c,b){var d={clickable:!1,cursor:"pointer",draggable:!1,flat:!0,icon:{url:CGMPGlobal.customMarkersUri+"gpsloc.png",size:new google.maps.Size(34,34),scaledSize:new google.maps.Size(17,17),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(8,8)},optimized:!1,position:new google.maps.LatLng(0,
        0),title:"Current location",zIndex:2};c&&(d=this.copyOptions_(d,c));c={clickable:!1,radius:0,strokeColor:"1bb6ff",strokeOpacity:0.4,fillColor:"61a0bf",fillOpacity:0.4,strokeWeight:1,zIndex:1};b&&(c=this.copyOptions_(c,b));this.marker_=new google.maps.Marker(d);this.circle_=new google.maps.Circle(c);this.map=this.position=this.accuracy=null;this.set("minimum_accuracy",null);this.set("position_options",{enableHighAccuracy:!0,maximumAge:1E3});this.circle_.bindTo("map",this.marker_);a&&this.setMap(a)}
        var u,D,J,T,H,S,p,G,K,z,I,N,l,U,v,A,W,F,X,s=null,V=!1,Q=!1,R=[],E=[];m.prototype=new google.maps.MVCObject;m.prototype.set=function(a,c){if(/^(?:position|accuracy)$/i.test(a))throw"'"+a+"' is a read-only property.";/map/i.test(a)?this.setMap(c):google.maps.MVCObject.prototype.set.apply(this,arguments)};m.prototype.marker_=null;m.prototype.circle_=null;m.prototype.getMap=function(){return this.map};m.prototype.getPositionOptions=function(){return this.get("position_options")};m.prototype.setPositionOptions=
            function(a){this.set("position_options",a)};m.prototype.getPosition=function(){return this.position};m.prototype.getBounds=function(){return this.position?this.circle_.getBounds():null};m.prototype.getAccuracy=function(){return this.accuracy};m.prototype.getMinimumAccuracy=function(){return this.get("minimum_accuracy")};m.prototype.setMinimumAccuracy=function(a){this.set("minimum_accuracy",a)};m.prototype.watchId_=-1;m.prototype.setMap=function(a){this.map=a;this.notify("map");a?this.watchPosition_():
            (this.marker_.unbind("position"),this.circle_.unbind("center"),this.circle_.unbind("radius"),this.position=this.accuracy=null,navigator.geolocation.clearWatch(this.watchId_),this.watchId_=-1,this.marker_.setMap(a))};m.prototype.setMarkerOptions=function(a){this.marker_.setOptions(this.copyOptions_({},a))};m.prototype.setCircleOptions=function(a){this.circle_.setOptions(this.copyOptions_({},a))};m.prototype.updatePosition_=function(a){var c=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),
            b=null==this.marker_.getMap();if(b){if(null!=this.getMinimumAccuracy()&&a.coords.accuracy>this.getMinimumAccuracy())return;this.marker_.setMap(this.map);this.marker_.bindTo("position",this);this.circle_.bindTo("center",this,"position");this.circle_.bindTo("radius",this,"accuracy")}this.accuracy!=a.coords.accuracy&&google.maps.MVCObject.prototype.set.call(this,"accuracy",a.coords.accuracy);!b&&null!=this.position&&this.position.equals(c)||google.maps.MVCObject.prototype.set.call(this,"position",c)};
        m.prototype.watchPosition_=function(){var a=this;navigator.geolocation&&(this.watchId_=navigator.geolocation.watchPosition(function(c){a.updatePosition_(c)},function(c){google.maps.event.trigger(a,"geolocation_error",c)},this.getPositionOptions()))};m.prototype.copyOptions_=function(a,c){for(var b in c)!0!==m.DISALLOWED_OPTIONS[b]&&(a[b]=c[b]);return a};m.DISALLOWED_OPTIONS={map:!0,position:!0,radius:!0};return{init:function(a,b,d,g){E=g;p=a;l=p.getDiv().id;K=b;J=d;google.maps.event.addListener(p,
            "click",function(){r()});u=[];D=[];N=5;z=I=G=H=null;T=S=!1;U=new google.maps.Geocoder;v=new google.maps.LatLngBounds;A=new google.maps.InfoWindow;W=new google.maps.StreetViewService;X=new google.maps.DirectionsService;rendererOptions={draggable:!0};F=new google.maps.DirectionsRenderer(rendererOptions);F.setPanel(document.getElementById("rendered-directions-placeholder-"+l))},setGeoLocationIfEnabled:function(a){"true"===a&&(s=new m,google.maps.event.addListenerOnce(s,"position_changed",function(){p.setCenter(this.getPosition());
            p.fitBounds(this.getBounds())}),google.maps.event.addListener(s,"geolocation_error",function(a){alert("There was an error creating Geolocation marker: "+a.message+"\n\nProceeding with normal map generation..");e.error("There was an error obtaining your position. Message: "+a.message);s=null}),s.setPositionOptions({enableHighAccuracy:!0,timeout:6E3,maximumAge:0}),s.setMap(p))},buildAddressMarkers:function(a,c,g){T=!0;G=x.trim(a);G=x.searchReplace(G,"'","");"true"===c?(V=!0,a=L(G),"true"===g?h(a,!0):
            "false"===g&&h(a,!1)):null!=c&&"false"!==c||b(G,"","","",!1,!1);O();d()},isBuildAddressMarkersCalled:function(){return T}}},x=function(){return{isNumeric:function(a){return/^([0-9?(\-.,;\s{1,})]+)$/.test(a)},isAlphaNumeric:function(a){return/^([a-zA-Z0-9?(/\-.,\s{1,})]+)$/.test(a)},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},searchReplace:function(a,g,e){return a.replace(RegExp(g,"g"),e)}}}(),e=function(){var a=function(a){navigator.userAgent.match(/msie|trident/i)||console.log(a)};return{info:function(g){a("Info :: "+
        g)},raw:function(g){a(g)},warn:function(g){a("Warning :: "+g)},error:function(g){a("Error :: "+g)},fatal:function(g){a("Fatal :: "+g)}}}(),C=function(){return{alertError:function(d){function g(b,d){b.preventDefault();var e=a(d).closest("div.cgmp-popup-shortcode-dialog");e&&a(e).remove();0==a("div.cgmp-popup-shortcode-dialog").length&&a("#cgmp-popup-mask").remove()}var e=a('<div id="cgmp-popup-mask"/>'),b=Math.random().toString(36).substring(3),n=a('<div id="'+b+'" class="cgmp-popup-shortcode-dialog cgmp-popup-window">');
        n.html("<div class='dismiss-container'><a class='dialog-dismiss' href='javascript:void(0)'>x</a></div><p style='text-align: left; padding: 10px 10px 0 10px'>"+d+"</p><div align='center'><input type='button' class='close-dialog' value='Close' /></div>");a("body").append(e);a("body").append(n);d=a(document).height();e=a(window).width();a("#cgmp-popup-mask").css({width:e,height:d,opacity:0.1});1==a("#cgmp-popup-mask").length&&a("#cgmp-popup-mask").show();d=a(window).height();e=a(window).width();a("div#"+
            b).css("top",d/2-a("div#"+b).height()/2);a("div#"+b).css("left",e/2-a("div#"+b).width()/2);a("div#"+b).fadeIn(500);a(".cgmp-popup-window .close-dialog").click(function(b){g(b,a(this))});a(".cgmp-popup-window .dialog-dismiss").click(function(b){g(b,a(this))});a("#cgmp-popup-mask").click(function(){a(this).remove();a(".cgmp-popup-window").remove()});a(window).resize(function(){var b=a(".window"),d=a(document).height(),e=a(window).width();a("#cgmp-popup-mask").css({width:e,height:d});d=a(window).height();
            e=a(window).width();b.css("top",d/2-b.height()/2);b.css("left",e/2-b.width()/2)})}}}(),t=document.head||document.getElementsByTagName("head")[0]||document.documentElement,r=document.createElement("link");r.type="text/css";r.rel="stylesheet";r.href=CGMPGlobal.cssHref;r.media="screen";t.appendChild(r);t=parseFloat(a.fn.jquery.split(".")[0]);r=parseFloat(a.fn.jquery.split(".")[1]);(1>t||1<=t&&2>t&&9>r)&&e.fatal("Client uses jQuery older than the version 1.9.0, check if he is using jQuery Migrate plugin");
    if("undefined"===typeof google||!google)return C.alertError(CGMPGlobal.msgNoGoogle),e.fatal("We do not have reference to Google API. Aborting map generation .."),!1;if("undefined"!==typeof GMap2&&GMap2)return C.alertError(CGMPGlobal.msgApiV2),e.fatal("It looks like the webpage has reference to GMap2 object from Google API v2. Aborting map generation .."),!1;google.load("maps","3",{other_params:"sensor=false&libraries=panoramio&language="+CGMPGlobal.language,callback:function(){n()}})})("undefined"!==
        typeof n&&null!=n&&n?n:jQuery)}if("undefined"===typeof jQuery||null==jQuery){var K=!1,w=document.head||document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("script");n.type="text/javascript";n.src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js";n.onload=n.onreadystatechange=function(){if(!K&&(!this.readyState||/loaded|complete/.test(n.readyState))){K=!0;var Y=jQuery.noConflict();B(Y);n.onload=n.onreadystatechange=null;w&&n.parentNode&&w.removeChild(n);
    n=void 0}};w.appendChild(n)}else B()})();