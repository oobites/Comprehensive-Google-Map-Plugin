(function(){function C(p){(function(a){function p(){a("object.cgmp-json-string-placeholder").each(function(n,b){var c=a(b).attr("id"),c=a(b).find("param#json-string-"+c).val(),c=y.searchReplace(c,"'",""),c=c.replace("&quot;",""),d=L(c);if("undefined"===typeof d||!d)return h.fatal("We did not parse JSON from OBJECT param. Aborting map generation .."),!1;if(0<a("div#"+d.id).length){var r=new google.maps.Map(document.getElementById(d.id));x.initMap(r,d.bubbleautopan,parseInt(d.zoom),d.maptype);z.init(r);
    c=new C;c.init(r,d.bubbleautopan,d.distanceunits,d);c.setGeoLocationIfEnabled(d.enablegeolocationmarker);x.setMapControls({mapTypeControl:"true"===d.maptypecontrol,panControl:"true"===d.pancontrol,zoomControl:"true"===d.zoomcontrol,scaleControl:"true"===d.scalecontrol,scrollwheel:"true"===d.scrollwheelcontrol,streetViewControl:"true"===d.streetviewcontrol,tilt:"true"===d.tiltfourtyfive?45:null,draggable:"true"===d.draggable,overviewMapControl:!0,overviewMapControlOptions:{opened:!1}});"true"===d.showpanoramio&&
    z.buildPanoramioLayer(d.panoramiouid);"true"===d.showbike&&z.buildBikeLayer();"true"===d.showtraffic&&z.buildTrafficLayer();null!=d.kml&&""!=y.trim(d.kml)?z.buildKmlLayer(d.kml):(null!=d.markerlist&&""!=y.trim(d.markerlist)&&c.buildAddressMarkers(d.markerlist,d.addmarkermashup,d.addmarkermashupbubble),c.isBuildAddressMarkersCalled()||D.alertError(CGMPGlobal.msgMissingMarkers));a(document).ready(function(){function b(){null!=n&&clearTimeout(n);a(p).is(":hidden")?n=setTimeout(b,c):setTimeout(function(){var a=
        r;if(a){var d=a.getZoom(),b=a.getBounds(),n=a.getCenter();google.maps.event.trigger(a,"resize");a.setZoom(d);a.setCenter(n);a.getBounds(b)}},c)}var n=null,c=500,p="div#"+d.id;a(p).is(":hidden")?(h.warn("Map placeholder DIV is hidden, must resize the map!"),b()):setTimeout(function(){b()},4*c)})}else h.fatal("It looks like the map DIV placeholder ID ["+d.id+"] does not exist in the page!")})}var L=function(a){},u=parseFloat(a.fn.jquery.split(".")[0]),s=parseFloat(a.fn.jquery.split(".")[1]);1<=u&&2>
    u&&4<=s?L=a.parseJSON:window.JSON&&window.JSON.parse?L=window.JSON.parse:h.fatal("Using parseJson stub..");var x=function(){var a={};return{initMap:function(b,h,d,r){a=b;b=[];for(var p in google.maps.MapTypeId)b.push(google.maps.MapTypeId[p]);"OSM"==r?(b.push(r),a.mapTypes.set(r,new google.maps.ImageMapType({getTileUrl:function(a,d){return"http://tile.openstreetmap.org/"+d+"/"+a.x+"/"+a.y+".png"},tileSize:new google.maps.Size(256,256),name:"OpenStreet",maxZoom:20}))):"ROADMAP"==r?r=google.maps.MapTypeId.ROADMAP:
    "SATELLITE"==r?r=google.maps.MapTypeId.SATELLITE:"HYBRID"==r?r=google.maps.MapTypeId.HYBRID:"TERRAIN"==r&&(r=google.maps.MapTypeId.TERRAIN);a.setOptions({zoom:d,mapTypeId:r,mapTypeControlOptions:{mapTypeIds:b}})},setMapControls:function(b){a.setOptions(b)}}}(),z=function(){var a={};return{init:function(b){a=b},buildKmlLayer:function(b){if(0>b.toLowerCase().indexOf("http"))return h.error("KML URL must start with HTTP(S). Aborting.."),!1;var c=new google.maps.KmlLayer(b);google.maps.event.addListener(c,
    "status_changed",function(){var a=c.getStatus();if(a!=google.maps.KmlLayerStatus.OK){var b="";switch(a){case google.maps.KmlLayerStatus.DOCUMENT_NOT_FOUND:b=CGMPGlobal.kmlNotFound;break;case google.maps.KmlLayerStatus.DOCUMENT_TOO_LARGE:b=CGMPGlobal.kmlTooLarge;break;case google.maps.KmlLayerStatus.FETCH_ERROR:b=CGMPGlobal.kmlFetchError;break;case google.maps.KmlLayerStatus.INVALID_DOCUMENT:b=CGMPGlobal.kmlDocInvalid;break;case google.maps.KmlLayerStatus.INVALID_REQUEST:b=CGMPGlobal.kmlRequestInvalid;
        break;case google.maps.KmlLayerStatus.LIMITS_EXCEEDED:b=CGMPGlobal.kmlLimits;break;case google.maps.KmlLayerStatus.TIMED_OUT:b=CGMPGlobal.kmlTimedOut;break;case google.maps.KmlLayerStatus.UNKNOWN:b=CGMPGlobal.kmlUnknown}if(""!=b){var n=CGMPGlobal.kml.replace("[MSG]",b),n=n.replace("[STATUS]",a);D.alertError(n);h.error("Google returned KML error: "+b+" ("+a+")");h.error("KML file: "+c.getUrl())}}});google.maps.event.addListener(c,"defaultviewport_changed",function(){});c.setMap(a)},buildTrafficLayer:function(){(new google.maps.TrafficLayer).setMap(a)},
    buildBikeLayer:function(){(new google.maps.BicyclingLayer).setMap(a)},buildPanoramioLayer:function(b){if("undefined"===typeof google.maps.panoramio||!google.maps.panoramio||null==google.maps.panoramio)return h.error("We cannot access Panoramio library. Aborting.."),!1;var c=new google.maps.panoramio.PanoramioLayer;c?(null!=b&&""!=b&&c.setUserId(b),c.setMap(a)):h.error("Could not instantiate Panoramio object. Aborting..")}}}(),C=function(){function n(){clearTimeout(I);if(0<E.length){var e=E.shift();
    h.info("Geocoding '"+e.address+"' Left "+E.length+" items to geocode..");U.geocode({address:e.address},function(a,f){b(a,f,e)})}else{s();if(P){h.warn("Reset server map data cache required");if(V){a.each(v,function(e,f){var g=(f.position+"").replace(RegExp("\\(|\\)","g"),"");a.each(Q,function(a,e){if(a===f.content&&-1!=e.validated_address_csv_data.indexOf(CGMPGlobal.geoValidationClientRevalidate))return e.validated_address_csv_data=e.validated_address_csv_data.replace(RegExp(CGMPGlobal.geoValidationClientRevalidate,
    "g"),g),!1})});var g=JSON.stringify(Q);a.post(CGMPGlobal.ajaxurl,{action:"cgmp_ajax_cache_map_action",data:g,geoMashup:"true"},function(a){h.info("Posting map data to the server..");null!=a&&"OK"===a&&h.info("Map geo mashup cache was reset on the server")})}else{var f=F.markerlist.split("|"),k=F.debug.widget_id,d=F.debug.post_id,c=F.debug.post_type,n=F.debug.shortcodeid,l=[];a.each(v,function(e,g){var k=(g.position+"").replace(RegExp("\\(|\\)","g"),"");a.each(f,function(a,f){var b=f.split(CGMPGlobal.sep);
    if(b[0]===g.content)return h.info(b[0]+" matched "+g.content+" (marker#"+(e+1)+")"),-1!=f.indexOf(CGMPGlobal.geoValidationClientRevalidate)?l[e]=f.replace(RegExp(CGMPGlobal.geoValidationClientRevalidate,"g"),k):l[e]=f,!1})});g=l.join("|");"undefined"!==typeof k&&"undefined"!==k?a.post(CGMPGlobal.ajaxurl,{action:"cgmp_ajax_cache_map_action",data:g,geoMashup:"false",widgetId:k},function(a){h.info("Posting map data to the server..");null!=a&&"OK_WIDGET"===a&&h.info("Map cache was reset on the server for widget#"+
    k)}):"undefined"!==typeof d&&"undefined"!==d&&a.post(CGMPGlobal.ajaxurl,{action:"cgmp_ajax_cache_map_action",data:g,geoMashup:"false",postId:d,postType:c,shortcodeId:n},function(a){h.info("Posting map data to the server..");null!=a&&("OK_POST"===a?h.info("Map cache was reset on the server for post#"+d+" shortcode#"+n):"OK_PAGE"===a?h.info("Map cache was reset on the server for page#"+d+" shortcode#"+n):"OK_CUSTOM"===a&&h.info("Map cache was reset on the server for type "+c+"#"+d+" shortcode#"+n))})}P=
    !1}h.info("Have "+v.length+" markers on the map")}}function b(a,g,f){g==google.maps.GeocoderStatus.OK?(h.info("Geocoding '"+f.address+"' OK!"),p(a[0].geometry.location,f),I=setTimeout(function(){n()},300)):g==google.maps.GeocoderStatus.OVER_QUERY_LIMIT?(s(),E.push(f),I=setTimeout(function(){n()},3E3)):g==google.maps.GeocoderStatus.ZERO_RESULTS&&(h.warn("Got ZERO_RESULTS for ["+f.address+"]"),I=setTimeout(function(){n()},300))}function c(e,g){var f=1;Q=e;a.each(e,function(a,e){if("live_debug"===a||
    "debug"===a)return!0;null==this.excerpt&&(this.excerpt="");"undefined"!==typeof this.validated_address_csv_data&&""!==this.validated_address_csv_data||h.error("Validated address from: "+this.permalink+" returned empty, perhaps OVER_QUERY_LIMIT when validating on the server..");d(this.validated_address_csv_data,this.title,this.permalink,this.excerpt,g,!0);f++})}function d(a,g,f,k,b,d){if("undefined"===typeof a||""===a)h.fatal("Not parsing empty validated address csv data.. Skipping");else{h.info("Raw: "+
    a);a=a.split("|");for(var n=0;n<a.length;n++){var c=a[n];if(null!=c&&""!=c){var c=c.split(CGMPGlobal.sep),l=c[0],m=c[1],q=c[2],c=c[3];-1!=q.indexOf(CGMPGlobal.noBubbleDescriptionProvided)&&(q="");l={address:l,animation:google.maps.Animation.DROP,zIndex:n+1,markerIcon:m,customBubbleText:q,markerHoverText:q+" ("+l+")",postTitle:g,postLink:f,postExcerpt:k,infoBubbleContainPostLink:b,geoMashup:d};if(c===CGMPGlobal.geoValidationClientRevalidate)P=!0,E.push(l);else{m=[];-1!=c.indexOf(",")?m=c.split(","):
    -1!=c.indexOf(";")&&(m=c.split(";"));m[0]=y.trim(m[0]);m[1]=y.trim(m[1]);if(""===m[0]||""===m[1])return h.warn("Lat or Long are empty string"),!1;c=new google.maps.LatLng(parseFloat(m[0]),parseFloat(m[1]));p(c,l)}}}}}function p(e,g){var f=new google.maps.Marker({position:e,title:g.markerHoverText,content:g.address,zIndex:g.zIndex+1E3,map:q});if(f){h.info("Built marker: "+g.address+" "+e);if(g.markerIcon){var k=g.markerIcon;if("undefined"==typeof k||"undefined"===k)k="1-default.png";f.setIcon(CGMPGlobal.customMarkersUri+
    k);var b=null,b=["4-default.png","5-default.png","6-default.png","7-default.png"];-1!=a.inArray(k,["1-default.png","2-default.png"])?(k=CGMPGlobal.customMarkersUri+"msmarker.shadow.png",b=M(k,59,32,0,0,16,33)):-1!=a.inArray(k,b)?(k=CGMPGlobal.customMarkersUri+"msmarker.shadow.png",b=M(k,59,32,0,0,21,34)):-1!=k.indexOf("3-default")?(k=CGMPGlobal.customMarkersUri+"beachflag_shadow.png",b=M(k,37,32,0,0,10,33)):b=M(CGMPGlobal.customMarkersUri+"shadow.png",68,37,0,0,32,38);f.setShadow(b)}x(f,g);R||(D(),
    R=!0);v.push(f)}}function M(a,g,f,k,b,d,c){return new google.maps.MarkerImage(a,new google.maps.Size(g,f),new google.maps.Point(k,b),new google.maps.Point(d,c))}function s(){var e=!1,g=null==t?!1:!0;1<v.length?(a.each(v,function(a,e){w.contains(e.position)||w.extend(e.position)}),e=!0):1==v.length&&(g?(w.extend(v[0].position),e=!0):(q.setCenter(v[0].position),N=q.getZoom(),J=q.getCenter()));e&&(g&&null!=t.getPosition()&&(h.info("Extended bounds with Geo marker position: "+t.getPosition()),w.extend(t.getPosition())),
    A=w,null!=w&&q.fitBounds(w))}function T(){null!=A?q.getCenter()!=A.getCenter()&&(h.info("Panning map back to its original bounds center: "+A.getCenter()),q.fitBounds(A),q.setCenter(A.getCenter())):null!=J&&(h.info("Panning map back to its original center: "+J+" and updated zoom: "+N),q.setCenter(J),q.setZoom(N))}function u(e){a(e+" input#a_address").val("");a(e+" input#b_address").val("");a(e+" input#a_address").removeClass("d_error");a(e+" input#b_address").removeClass("d_error");a("input#"+l+"_avoid_hway").prop("checked",
    !1);a("input#"+l+"_avoid_tolls").prop("checked",!1);a("input#"+l+"_radio_km").prop("checked",!1);a("input#"+l+"_radio_miles").prop("checked",!0)}function x(e,g){var f=O(e.content,g),k="div#direction-controls-placeholder-"+l,b=a("div#rendered-directions-placeholder-"+l);google.maps.event.addListener(e,"click",function(){u(k);a(k).fadeOut();G.setMap(null);b.html("");b.hide();a(k+" button#print_sub").hide();C(e,f,k);z(e,f,k,b);B.setContent(f.bubbleContent);B.setOptions({disableAutoPan:"true"===W?!1:
    !0});B.open(q,this)})}function z(e,g,f,b){var d="div#bubble-"+g.bubbleHolderId,c=e.content,c=c.replace("Lat/Long: ",""),n=!1==(null==t?!1:!0)||null==t.getPosition()?"":t.getPosition();a(document).on("click",d+" a.dirToHereTrigger",function(){this.id==="toHere-"+g.bubbleHolderId&&(a(f).fadeIn(),a(f+" input#a_address").val(n),a(f+" input#b_address").val(c),"miles"===K?(a("input#"+l+"_radio_miles").prop("checked",!0),a("input#"+l+"_radio_km").prop("checked",!1)):"km"===K&&(a("input#"+l+"_radio_km").prop("checked",
    !0),a("input#"+l+"_radio_miles").prop("checked",!1)))});a(document).on("click",d+" a.dirFromHereTrigger",function(){this.id==="fromHere-"+g.bubbleHolderId&&(a(f).fadeIn(),a(f+" input#a_address").val(c),a(f+" input#b_address").val(n),"miles"===K?(a("input#"+l+"_radio_miles").prop("checked",!0),a("input#"+l+"_radio_km").prop("checked",!1)):"km"===K&&(a("input#"+l+"_radio_km").prop("checked",!0),a("input#"+l+"_radio_miles").prop("checked",!1)))});a(document).on("click",f+" div.d_close-wrapper",function(e){u(f);
    a(this).parent().fadeOut();G.setMap(null);b.html("");b.hide();a(f+" button#print_sub").hide();T();return!1})}function C(e,g,f){X.getPanoramaByLocation(e.position,50,function(b,c){if(c===google.maps.StreetViewStatus.OK)a(document).on("click","a#trigger-"+g.bubbleHolderId,function(){var b={navigationControl:!0,enableCloseButton:!0,addressControl:!1,linksControl:!0,scrollwheel:!1,addressControlOptions:{position:google.maps.ControlPosition.BOTTOM},position:e.position,pov:{heading:165,pitch:0,zoom:1}},
    k=new google.maps.StreetViewPanorama(document.getElementById("bubble-"+g.bubbleHolderId),b);k.setVisible(!0);google.maps.event.addListener(B,"closeclick",function(){u(f);a(f).fadeOut();null!=k&&(k.unbind("position"),k.setVisible(!1));k=null});google.maps.event.addListener(k,"closeclick",function(){null!=k&&(k.unbind("position"),k.setVisible(!1),a("div#bubble-"+g.bubbleHolderId).css("background","none"));k=null})});else h.warn("There is not street view available for this marker location: "+e.position+
    " status: "+c),a(document).on("click","a#trigger-"+g.bubbleHolderId,function(a){a.preventDefault()}),a("a#trigger-"+g.bubbleHolderId).attr("style","text-decoration: none !important; color: #ddd !important"),google.maps.event.addListener(B,"domready",function(){a("a#trigger-"+g.bubbleHolderId).removeAttr("href");a("a#trigger-"+g.bubbleHolderId).attr("style","text-decoration: none !important; color: #ddd !important")})})}function D(){var e="div#direction-controls-placeholder-"+l,g=a("div#rendered-directions-placeholder-"+
    l);a(document).on("click",e+" a#reverse-btn",function(f){f=a(e+" input#a_address").val();var g=a(e+" input#b_address").val();a(e+" input#a_address").val(g);a(e+" input#b_address").val(f);return!1});a(document).on("click",e+" a#d_options_show",function(){a(e+" a#d_options_hide").show();a(e+" a#d_options_show").hide();a(e+" div#d_options").show();return!1});a(document).on("click",e+" a#d_options_hide",function(){a(e+" a#d_options_hide").hide();a(e+" a#d_options_show").show();a(e+" div#d_options").hide();
    a("input#"+l+"_avoid_hway").prop("checked",!1);a("input#"+l+"_avoid_tolls").prop("checked",!1);a("input#"+l+"_radio_km").prop("checked",!1);a("input#"+l+"_radio_miles").prop("checked",!0);return!1});a(document).on("click",e+" button#d_sub",function(){var f=a(e+" input#a_address").val(),b=a(e+" input#b_address").val(),c=!1;if(null==f||""==f)a(e+" input#a_address").addClass("d_error"),c=!0;if(null==b||""==b)a(e+" input#b_address").addClass("d_error"),c=!0;if(!c){a(e+" button#d_sub").prop("disabled",
    !0).html("Please wait..");var d=google.maps.DirectionsTravelMode.DRIVING;a(e+" a#dir_w_btn").hasClass("selected")&&(d=google.maps.DirectionsTravelMode.WALKING);var c=a("input#"+l+"_avoid_hway").is(":checked"),n=a("input#"+l+"_avoid_tolls").is(":checked"),m=a("input#"+l+"_radio_miles").is(":checked"),d={origin:f,destination:b,travelMode:d,provideRouteAlternatives:!0};c&&(d.avoidHighways=!0);n&&(d.avoidTolls=!0);d.unitSystem=m?google.maps.DirectionsUnitSystem.IMPERIAL:google.maps.DirectionsUnitSystem.METRIC;
    Y.route(d,function(c,d){d==google.maps.DirectionsStatus.OK?(g.html(""),g.show(),G.setMap(q),G.setDirections(c),a(e+" button#d_sub").removeAttr("disabled").html("Get directions"),a(e+" button#print_sub").fadeIn(),B.close()):(h.error('Could not route directions from "'+f+'" to "'+b+'", got result from Google: '+d),g.html("<span style='font-size: 12px; font-weight: bold; color: red'>Could not route directions from<br />'"+f+"' to<br />'"+b+"'<br />Got result from Google: ["+d+"]</span>"),a(e+" button#print_sub").hide(),
        a(e+" button#d_sub").removeAttr("disabled").html("Get directions"))})}});a(document).on("click",e+" button#print_sub",function(){var f=a(e+" input#a_address").val(),g=a(e+" input#b_address").val(),b="d";a(e+" a#dir_w_btn").hasClass("selected")&&(b="w");f="http://maps.google.com/?saddr="+f+"&daddr="+g+"&dirflg="+b+"&pw=2";f=a("input#"+l+"_radio_miles").is(":checked")?f+"&doflg=ptm":f+"&doflg=ptk";"d"===b&&(b=a("input#"+l+"_avoid_hway").is(":checked"),g=a("input#"+l+"_avoid_tolls").is(":checked"),b&&
    (f+="&dirflg=h"),g&&(f+="&dirflg=t"));window.open(f);return!1});a(document).on("change focus",e+" input#a_address",function(){a(e+" input#a_address").removeClass("d_error");return!1});a(document).on("change focus",e+" input#b_address",function(){a(e+" input#b_address").removeClass("d_error");return!1});a(document).on("click",e+" .kd-button",function(){var b=this.id;"dir_d_btn"==b?a(e+" a#dir_d_btn").hasClass("selected")?h.warn("Driving travel mode is already selected"):(a(e+" a#dir_d_btn").addClass("selected"),
    a(e+" a#dir_w_btn").removeClass("selected")):"dir_w_btn"==b&&(a(e+" a#dir_w_btn").hasClass("selected")?h.warn("Walking travel mode is already selected"):(a(e+" a#dir_w_btn").addClass("selected"),a(e+" a#dir_d_btn").removeClass("selected")));return!1})}function O(a,b){var f=Math.floor(111111*Math.random()),f=f+"-"+l,c="<div id='bubble-"+f+"' style='height: 130px !important; width: 300px !important;' class='bubble-content'>";if(!b.geoMashup||b.geoMashup&&!b.infoBubbleContainPostLink)c+="<h4>"+CGMPGlobal.address+
    ":</h4>",c+="<p class='custom-bubble-text'>"+a+"</p>",""!=b.customBubbleText&&(c+="<p class='custom-bubble-text'>"+b.customBubbleText+"</p>");else var d=b.postTitle.substring(0,30),c=c+""+("<p class='geo-mashup-post-title'><a title='Original post: "+b.postTitle+"' href='"+b.postLink+"'>"+d+"..</a></p>"),c=c+("<p class='geo-mashup-post-excerpt'>"+b.postExcerpt+"</p>");c+="<div class='custom-bubble-links-section'>";c+="<hr />";c+="<p class='custom-bubble-text'>"+CGMPGlobal.directions+": <a id='toHere-"+
    f+"' class='dirToHereTrigger' href='javascript:void(0);'>"+CGMPGlobal.toHere+"</a> - <a id='fromHere-"+f+"' class='dirFromHereTrigger' href='javascript:void(0);'>"+CGMPGlobal.fromHere+"</a> | <a id='trigger-"+f+"' class='streetViewTrigger' href='javascript:void(0);'>"+CGMPGlobal.streetView+"</a></p>";c+="</div></div>";return{bubbleHolderId:f,bubbleContent:c}}function m(a,b,c){var d={clickable:!1,cursor:"pointer",draggable:!1,flat:!0,icon:{url:CGMPGlobal.customMarkersUri+"gpsloc.png",size:new google.maps.Size(34,
    34),scaledSize:new google.maps.Size(17,17),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(8,8)},optimized:!1,position:new google.maps.LatLng(0,0),title:"Current location",zIndex:2};b&&(d=this.copyOptions_(d,b));b={clickable:!1,radius:0,strokeColor:"1bb6ff",strokeOpacity:0.4,fillColor:"61a0bf",fillOpacity:0.4,strokeWeight:1,zIndex:1};c&&(b=this.copyOptions_(b,c));this.marker_=new google.maps.Marker(d);this.circle_=new google.maps.Circle(b);this.map=this.position=this.accuracy=null;
    this.set("minimum_accuracy",null);this.set("position_options",{enableHighAccuracy:!0,maximumAge:1E3});this.circle_.bindTo("map",this.marker_);a&&this.setMap(a)}var v,E,K,S,I,R,q,H,W,A,J,N,l,U,w,B,X,G,Y,t=null,V=!1,P=!1,Q=[],F=[];m.prototype=new google.maps.MVCObject;m.prototype.set=function(a,b){if(/^(?:position|accuracy)$/i.test(a))throw"'"+a+"' is a read-only property.";/map/i.test(a)?this.setMap(b):google.maps.MVCObject.prototype.set.apply(this,arguments)};m.prototype.marker_=null;m.prototype.circle_=
    null;m.prototype.getMap=function(){return this.map};m.prototype.getPositionOptions=function(){return this.get("position_options")};m.prototype.setPositionOptions=function(a){this.set("position_options",a)};m.prototype.getPosition=function(){return this.position};m.prototype.getBounds=function(){return this.position?this.circle_.getBounds():null};m.prototype.getAccuracy=function(){return this.accuracy};m.prototype.getMinimumAccuracy=function(){return this.get("minimum_accuracy")};m.prototype.setMinimumAccuracy=
    function(a){this.set("minimum_accuracy",a)};m.prototype.watchId_=-1;m.prototype.setMap=function(a){this.map=a;this.notify("map");a?this.watchPosition_():(this.marker_.unbind("position"),this.circle_.unbind("center"),this.circle_.unbind("radius"),this.position=this.accuracy=null,navigator.geolocation.clearWatch(this.watchId_),this.watchId_=-1,this.marker_.setMap(a))};m.prototype.setMarkerOptions=function(a){this.marker_.setOptions(this.copyOptions_({},a))};m.prototype.setCircleOptions=function(a){this.circle_.setOptions(this.copyOptions_({},
    a))};m.prototype.updatePosition_=function(a){var b=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),c=null==this.marker_.getMap();if(c){if(null!=this.getMinimumAccuracy()&&a.coords.accuracy>this.getMinimumAccuracy())return;this.marker_.setMap(this.map);this.marker_.bindTo("position",this);this.circle_.bindTo("center",this,"position");this.circle_.bindTo("radius",this,"accuracy")}this.accuracy!=a.coords.accuracy&&google.maps.MVCObject.prototype.set.call(this,"accuracy",a.coords.accuracy);
    !c&&null!=this.position&&this.position.equals(b)||google.maps.MVCObject.prototype.set.call(this,"position",b)};m.prototype.watchPosition_=function(){var a=this;navigator.geolocation&&(this.watchId_=navigator.geolocation.watchPosition(function(b){a.updatePosition_(b)},function(b){google.maps.event.trigger(a,"geolocation_error",b)},this.getPositionOptions()))};m.prototype.copyOptions_=function(a,b){for(var c in b)!0!==m.DISALLOWED_OPTIONS[c]&&(a[c]=b[c]);return a};m.DISALLOWED_OPTIONS={map:!0,position:!0,
    radius:!0};return{init:function(a,b,c,d){F=d;q=a;l=q.getDiv().id;W=b;K=c;google.maps.event.addListener(q,"click",function(){T()});v=[];E=[];N=5;A=J=H=I=null;S=R=!1;U=new google.maps.Geocoder;w=new google.maps.LatLngBounds;B=new google.maps.InfoWindow;X=new google.maps.StreetViewService;Y=new google.maps.DirectionsService;rendererOptions={draggable:!0};G=new google.maps.DirectionsRenderer(rendererOptions);G.setPanel(document.getElementById("rendered-directions-placeholder-"+l))},setGeoLocationIfEnabled:function(a){"true"===
    a&&(t=new m,google.maps.event.addListenerOnce(t,"position_changed",function(){q.setCenter(this.getPosition());q.fitBounds(this.getBounds())}),google.maps.event.addListener(t,"geolocation_error",function(a){alert("There was an error creating Geolocation marker: "+a.message+"\n\nProceeding with normal map generation..");h.error("There was an error obtaining your position. Message: "+a.message);t=null}),t.setPositionOptions({enableHighAccuracy:!0,timeout:6E3,maximumAge:0}),t.setMap(q))},buildAddressMarkers:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          b,f){S=!0;H=y.trim(a);H=y.searchReplace(H,"'","");"true"===b?(V=!0,a=L(H),"true"===f?c(a,!0):"false"===f&&c(a,!1)):null!=b&&"false"!==b||d(H,"","","",!1,!1);s();n()},isBuildAddressMarkersCalled:function(){return S}}},y=function(){return{isNumeric:function(a){return/^([0-9?(\-.,;\s{1,})]+)$/.test(a)},isAlphaNumeric:function(a){return/^([a-zA-Z0-9?(/\-.,\s{1,})]+)$/.test(a)},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},searchReplace:function(a,b,c){return a.replace(RegExp(b,"g"),c)}}}(),h=function(){var a=
    function(a){navigator.userAgent.match(/msie|trident/i)||console.log(a)};return{info:function(b){a("Info :: "+b)},raw:function(b){a(b)},warn:function(b){a("Warning :: "+b)},error:function(b){a("Error :: "+b)},fatal:function(b){a("Fatal :: "+b)}}}(),D=function(){return{alertError:function(h){function b(b,c){b.preventDefault();var d=a(c).closest("div.cgmp-popup-shortcode-dialog");d&&a(d).remove();0==a("div.cgmp-popup-shortcode-dialog").length&&a("#cgmp-popup-mask").remove()}var c=a('<div id="cgmp-popup-mask"/>'),
    d=Math.random().toString(36).substring(3),p=a('<div id="'+d+'" class="cgmp-popup-shortcode-dialog cgmp-popup-window">');p.html("<div class='dismiss-container'><a class='dialog-dismiss' href='javascript:void(0)'>x</a></div><p style='text-align: left; padding: 10px 10px 0 10px'>"+h+"</p><div align='center'><input type='button' class='close-dialog' value='Close' /></div>");a("body").append(c);a("body").append(p);h=a(document).height();c=a(window).width();a("#cgmp-popup-mask").css({width:c,height:h,opacity:0.1});
    1==a("#cgmp-popup-mask").length&&a("#cgmp-popup-mask").show();h=a(window).height();c=a(window).width();a("div#"+d).css("top",h/2-a("div#"+d).height()/2);a("div#"+d).css("left",c/2-a("div#"+d).width()/2);a("div#"+d).fadeIn(500);a(".cgmp-popup-window .close-dialog").click(function(c){b(c,a(this))});a(".cgmp-popup-window .dialog-dismiss").click(function(c){b(c,a(this))});a("#cgmp-popup-mask").click(function(){a(this).remove();a(".cgmp-popup-window").remove()});a(window).resize(function(){var b=a(".window"),
        c=a(document).height(),d=a(window).width();a("#cgmp-popup-mask").css({width:d,height:c});c=a(window).height();d=a(window).width();b.css("top",c/2-b.height()/2);b.css("left",d/2-b.width()/2)})}}}(),u=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s=document.createElement("link");s.type="text/css";s.rel="stylesheet";s.href=CGMPGlobal.cssHref;s.media="screen";u.appendChild(s);u=parseFloat(a.fn.jquery.split(".")[0]);s=parseFloat(a.fn.jquery.split(".")[1]);if(1>u||1<=
    u&&2>u&&9>s)return h.fatal("Client uses jQuery older than the version 1.9.0. Aborting map generation .."),!1;if("undefined"===typeof google||!google)return D.alertError(CGMPGlobal.msgNoGoogle),h.fatal("We do not have reference to Google API. Aborting map generation .."),!1;if("undefined"!==typeof GMap2&&GMap2)return D.alertError(CGMPGlobal.msgApiV2),h.fatal("It looks like the webpage has reference to GMap2 object from Google API v2. Aborting map generation .."),!1;google.load("maps","3",{other_params:"sensor=false&libraries=panoramio&language="+
    CGMPGlobal.language,callback:function(){p()}})})("undefined"!==typeof p&&null!=p&&p?p:jQuery)}if("undefined"===typeof jQuery||null==jQuery){var O=!1,x=document.head||document.getElementsByTagName("head")[0]||document.documentElement,p=document.createElement("script");p.type="text/javascript";p.src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js";p.onload=p.onreadystatechange=function(){if(!O&&(!this.readyState||/loaded|complete/.test(p.readyState))){O=!0;var Z=jQuery.noConflict();
    C(Z);p.onload=p.onreadystatechange=null;x&&p.parentNode&&x.removeChild(p);p=void 0}};x.appendChild(p)}else C()})();