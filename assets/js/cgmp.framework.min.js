(function(){function q(g){(function(a){function g(){a("object.cgmp-json-string-placeholder").each(function(p,x){var d=a(x).attr("id"),d=a(x).find("param#json-string-"+d).val(),d=y.searchReplace(d,"'",""),d=d.replace("&quot;",""),b=q(d);if("undefined"===typeof b||!b)return c.fatal("We did not parse JSON from OBJECT param. Aborting map generation .."),!1;if(0<a("div#"+b.id).length){var f=navigator.userAgent,d=document.getElementById(b.id);f.match(/Android|BlackBerry|IEMobile|i(Phone|Pad|Pod)|Kindle|MeeGo|NetFront|Nokia|Opera M(ob|in)i|Pie|PalmOS|PDA|Polaris|Plucker|Samsung|SonyEricsson|SymbianOS|UP.Browser|Vodafone|webOS|Windows Phone/i)&&
(d.style.width="100%",f=a(window).height()+"",-1!=f.indexOf("px")?d.style.height=f:-1!=f.indexOf("%")?d.style.height="100%":d.style.height=f+"px");var g=new google.maps.Map(d);if("undefined"!==typeof b.styles&&""!==y.trim(b.styles)){b.styles=base64_decode(b.styles);try{b.styles=q(b.styles)}catch(n){c.fatal("Could not parse map styles as a JSON object"),b.styles=""}}else b.styles="";u.initMap(g,b.bubbleautopan,parseInt(b.zoom),b.maptype,b.styles);t.init(g);d=new P;d.init(g,b.bubbleautopan,b.distanceunits,
    b);d.setGeoLocationIfEnabled(b.enablegeolocationmarker);u.setMapControls({mapTypeControl:"true"===b.maptypecontrol,panControl:"true"===b.pancontrol,zoomControl:"true"===b.zoomcontrol,scaleControl:"true"===b.scalecontrol,scrollwheel:"true"===b.scrollwheelcontrol,streetViewControl:"true"===b.streetviewcontrol,tilt:"true"===b.tiltfourtyfive?45:null,draggable:"true"===b.draggable,overviewMapControl:!0,overviewMapControlOptions:{opened:!1}});"true"===b.showpanoramio&&t.buildPanoramioLayer(b.panoramiouid);
    "true"===b.showbike&&t.buildBikeLayer();"true"===b.showtraffic&&t.buildTrafficLayer();null!=b.kml&&""!=y.trim(b.kml)?t.buildKmlLayer(b.kml):(null!=b.markerlist&&""!=y.trim(b.markerlist)&&d.buildAddressMarkers(b.markerlist,b.addmarkermashup,b.addmarkermashupbubble),d.isBuildAddressMarkersCalled()||D.alertError(CGMPGlobal.msgMissingMarkers));a(document).ready(function(){function d(){null!=p&&clearTimeout(p);p=a(n).is(":hidden")?setTimeout(d,f):setTimeout(function(){x(g)},f)}function x(a){null!=p&&clearTimeout(p);
        a&&(google.maps.event.trigger(a,"resize"),p=setTimeout(function(){null!=p&&clearTimeout(p);a&&google.maps.event.trigger(a,"click")},f/2))}var p=null,f=500,n="div#"+b.id;a(n).is(":hidden")?(c.warn("Map placeholder DIV is hidden, must resize the map!"),d()):p=setTimeout(function(){d()},3*f)})}else c.fatal("It looks like the map DIV placeholder ID ["+b.id+"] does not exist in the page!")})}var q=function(a){},s=parseFloat(a.fn.jquery.split(".")[0]),n=parseFloat(a.fn.jquery.split(".")[1]);1<=s&&2>s&&
    4<=n?q=a.parseJSON:window.JSON&&window.JSON.parse?q=window.JSON.parse:c.fatal("Using parseJson stub..");var u=function(){var a={};return{initMap:function(c,d,b,f,g){a=c;c=[];for(var n in google.maps.MapTypeId)c.push(google.maps.MapTypeId[n]);"OSM"==f?(c.push(f),a.mapTypes.set(f,new google.maps.ImageMapType({getTileUrl:function(a,b){return"http://tile.openstreetmap.org/"+b+"/"+a.x+"/"+a.y+".png"},tileSize:new google.maps.Size(256,256),name:"OpenStreet",maxZoom:20}))):"ROADMAP"==f?f=google.maps.MapTypeId.ROADMAP:
    "SATELLITE"==f?f=google.maps.MapTypeId.SATELLITE:"HYBRID"==f?f=google.maps.MapTypeId.HYBRID:"TERRAIN"==f&&(f=google.maps.MapTypeId.TERRAIN);a.setOptions({zoom:b,mapTypeId:f,styles:g,mapTypeControlOptions:{mapTypeIds:c}})},setMapControls:function(c){a.setOptions(c)}}}(),t=function(){var a={};return{init:function(c){a=c},buildKmlLayer:function(g){if(0>g.toLowerCase().indexOf("http"))return c.error("KML URL must start with HTTP(S). Aborting.."),!1;var d=new google.maps.KmlLayer(g);google.maps.event.addListener(d,
    "status_changed",function(){var a=d.getStatus();if(a!=google.maps.KmlLayerStatus.OK){var f="";switch(a){case google.maps.KmlLayerStatus.DOCUMENT_NOT_FOUND:f=CGMPGlobal.kmlNotFound;break;case google.maps.KmlLayerStatus.DOCUMENT_TOO_LARGE:f=CGMPGlobal.kmlTooLarge;break;case google.maps.KmlLayerStatus.FETCH_ERROR:f=CGMPGlobal.kmlFetchError;break;case google.maps.KmlLayerStatus.INVALID_DOCUMENT:f=CGMPGlobal.kmlDocInvalid;break;case google.maps.KmlLayerStatus.INVALID_REQUEST:f=CGMPGlobal.kmlRequestInvalid;
        break;case google.maps.KmlLayerStatus.LIMITS_EXCEEDED:f=CGMPGlobal.kmlLimits;break;case google.maps.KmlLayerStatus.TIMED_OUT:f=CGMPGlobal.kmlTimedOut;break;case google.maps.KmlLayerStatus.UNKNOWN:f=CGMPGlobal.kmlUnknown}if(""!=f){var p=CGMPGlobal.kml.replace("[MSG]",f),p=p.replace("[STATUS]",a);D.alertError(p);c.error("Google returned KML error: "+f+" ("+a+")");c.error("KML file: "+d.getUrl())}}});google.maps.event.addListener(d,"defaultviewport_changed",function(){});d.setMap(a)},buildTrafficLayer:function(){(new google.maps.TrafficLayer).setMap(a)},
    buildBikeLayer:function(){(new google.maps.BicyclingLayer).setMap(a)},buildPanoramioLayer:function(g){if("undefined"===typeof google.maps.panoramio||!google.maps.panoramio||null==google.maps.panoramio)return c.error("We cannot access Panoramio library. Aborting.."),!1;var d=new google.maps.panoramio.PanoramioLayer;d?(null!=g&&""!=g&&d.setUserId(g),d.setMap(a)):c.error("Could not instantiate Panoramio object. Aborting..")}}}(),P=function(){function g(){clearTimeout(J);if(0<E.length){var e=E.shift();
    c.info("Geocoding '"+e.address+"' Left "+E.length+" items to geocode..");U.geocode({address:e.address},function(a,k){n(a,k,e)})}else{O();if(Q){c.warn("Reset server map data cache required");if(V){a.each(w,function(e,k){var h=(k.position+"").replace(RegExp("\\(|\\)","g"),"");a.each(R,function(a,e){if(a===k.content&&-1!=e.validated_address_csv_data.indexOf(CGMPGlobal.geoValidationClientRevalidate))return e.validated_address_csv_data=e.validated_address_csv_data.replace(RegExp(CGMPGlobal.geoValidationClientRevalidate,
    "g"),h),!1})});var h=JSON.stringify(R);a.post(CGMPGlobal.ajaxurl,{action:CGMPGlobal.ajaxCacheMapAction,data:h,geoMashup:"true",timestamp:CGMPGlobal.timestamp},function(a){c.info("Posting map data to the server..");null!=a&&"OK"===a&&c.info("Map geo mashup cache was reset on the server")})}else{var k=F.markerlist.split("|"),G=F.debug.widget_id,b=F.debug.post_id,d=F.debug.post_type,f=F.debug.shortcodeid,p=[];a.each(w,function(e,h){var G=(h.position+"").replace(RegExp("\\(|\\)","g"),"");a.each(k,function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               k){var b=k.split(CGMPGlobal.sep);if(b[0]===h.content)return c.info(b[0]+" matched "+h.content+" (marker#"+(e+1)+")"),-1!=k.indexOf(CGMPGlobal.geoValidationClientRevalidate)?p[e]=k.replace(RegExp(CGMPGlobal.geoValidationClientRevalidate,"g"),G):p[e]=k,!1})});h=p.join("|");"undefined"!==typeof G&&"undefined"!==G?a.post(CGMPGlobal.ajaxurl,{action:CGMPGlobal.ajaxCacheMapAction,data:h,geoMashup:"false",widgetId:G,timestamp:CGMPGlobal.timestamp},function(a){c.info("Posting map data to the server..");null!=
    a&&"OK_WIDGET"===a&&c.info("Map cache was reset on the server for widget#"+G)}):"undefined"!==typeof b&&"undefined"!==b&&a.post(CGMPGlobal.ajaxurl,{action:CGMPGlobal.ajaxCacheMapAction,data:h,geoMashup:"false",postId:b,postType:d,shortcodeId:f,timestamp:CGMPGlobal.timestamp},function(a){c.info("Posting map data to the server..");null!=a&&("OK_POST"===a?c.info("Map cache was reset on the server for post#"+b+" shortcode#"+f):"OK_PAGE"===a?c.info("Map cache was reset on the server for page#"+b+" shortcode#"+
    f):"OK_CUSTOM"===a&&c.info("Map cache was reset on the server for type "+d+"#"+b+" shortcode#"+f))})}Q=!1}c.info("Have "+w.length+" markers on the map")}}function n(a,h,k){h==google.maps.GeocoderStatus.OK?(c.info("Geocoding '"+k.address+"' OK!"),f(a[0].geometry.location,k),J=setTimeout(function(){g()},200)):h==google.maps.GeocoderStatus.OVER_QUERY_LIMIT?(c.warn("Geocoding '"+k.address+"' OVER_QUERY_LIMIT!"),O(),E.push(k),J=setTimeout(function(){g()},2200)):(h==google.maps.GeocoderStatus.ZERO_RESULTS?
    c.warn("Geocoding '"+k.address+"' ZERO_RESULTS!"):c.warn("Geocoding '"+k.address+"' "+h+"!"),J=setTimeout(function(){g()},200))}function d(e,h){var k=1;R=e;a.each(e,function(a,e){if("live_debug"===a||"debug"===a)return!0;null==this.excerpt&&(this.excerpt="");"undefined"!==typeof this.validated_address_csv_data&&""!==this.validated_address_csv_data||c.error("Validated address from: "+this.permalink+" returned empty, perhaps OVER_QUERY_LIMIT when validating on the server..");b(this.validated_address_csv_data,
    this.title,this.permalink,this.excerpt,h,!0);k++})}function b(a,h,k,b,d,g){if("undefined"===typeof a||""===a)c.fatal("Not parsing empty validated address csv data.. Skipping");else{c.info("Raw: "+a);a=a.split("|");for(var p=0;p<a.length;p++){var l=a[p];if(null!=l&&""!=l){var l=l.split(CGMPGlobal.sep),n=l[0],m=l[1],x=l[2],l=l[3];-1!=x.indexOf(CGMPGlobal.noBubbleDescriptionProvided)&&(x="");n={address:n,animation:google.maps.Animation.DROP,zIndex:p+1,markerIcon:m,customBubbleText:x,markerHoverText:x+
    " ("+n+")",postTitle:h,postLink:k,postExcerpt:b,infoBubbleContainPostLink:d,geoMashup:g};if(l===CGMPGlobal.geoValidationClientRevalidate)Q=!0,E.push(n);else{m=[];-1!=l.indexOf(",")?m=l.split(","):-1!=l.indexOf(";")&&(m=l.split(";"));m[0]=y.trim(m[0]);m[1]=y.trim(m[1]);if(""===m[0]||""===m[1])return c.warn("Lat or Long are empty string"),!1;l=new google.maps.LatLng(parseFloat(m[0]),parseFloat(m[1]));f(l,n)}}}}}function f(a,h){var k=new google.maps.Marker({position:a,title:h.markerHoverText,content:h.address,
    zIndex:h.zIndex+1E3,map:r});if(k){c.info("Built marker: "+h.address+" "+a);if(h.markerIcon){var b=h.markerIcon;if("undefined"==typeof b||"undefined"===b)b="1-default.png";"1-default.png"!==b&&k.setIcon(CGMPGlobal.customMarkersUri+b)}u(k,h);S||(P(),S=!0);w.push(k)}}function O(){var e=!1,h=null==v?!1:!0;1<w.length?(a.each(w,function(a,e){z.contains(e.position)||z.extend(e.position)}),e=!0):1==w.length&&(h?(z.extend(w[0].position),e=!0):(r.setCenter(w[0].position),M=r.getZoom(),K=r.getCenter()));e&&
(h&&null!=v.getPosition()&&(c.info("Extended bounds with Geo marker position: "+v.getPosition()),z.extend(v.getPosition())),B=z,null!=z&&r.fitBounds(z))}function t(){null!=B?r.getCenter()!=B.getCenter()&&(c.info("Panning map back to its original bounds center: "+B.getCenter()),r.fitBounds(B),r.setCenter(B.getCenter())):null!=K&&(c.info("Panning map back to its original center: "+K+" and updated zoom: "+M),r.setCenter(K),r.setZoom(M))}function s(e){a(e+" input#a_address").val("");a(e+" input#b_address").val("");
    a(e+" input#a_address").removeClass("d_error");a(e+" input#b_address").removeClass("d_error");a("input#"+l+"_avoid_hway").prop("checked",!1);a("input#"+l+"_avoid_tolls").prop("checked",!1);a("input#"+l+"_radio_km").prop("checked",!1);a("input#"+l+"_radio_miles").prop("checked",!0)}function u(e,h){var k=Z(e.content,h),b="div#direction-controls-placeholder-"+l,c=a("div#rendered-directions-placeholder-"+l);google.maps.event.addListener(e,"click",function(){s(b);a(b).fadeOut();H.setMap(null);c.html("");
    c.hide();a(b+" button#print_sub").hide();D(e,k,b);A(e,k,b,c);C.setContent(k.bubbleContent);C.setOptions({disableAutoPan:"true"===W?!1:!0});C.open(r,this)})}function A(e,h,k,b){var c="div#bubble-"+h.bubbleHolderId,d=e.content,d=d.replace("Lat/Long: ",""),f=!1==(null==v?!1:!0)||null==v.getPosition()?"":v.getPosition();a(document).on("click",c+" a.dirToHereTrigger",function(){this.id==="toHere-"+h.bubbleHolderId&&(a(k).fadeIn(),a(k+" input#a_address").val(f),a(k+" input#b_address").val(d),"miles"===
    L?(a("input#"+l+"_radio_miles").prop("checked",!0),a("input#"+l+"_radio_km").prop("checked",!1)):"km"===L&&(a("input#"+l+"_radio_km").prop("checked",!0),a("input#"+l+"_radio_miles").prop("checked",!1)))});a(document).on("click",c+" a.dirFromHereTrigger",function(){this.id==="fromHere-"+h.bubbleHolderId&&(a(k).fadeIn(),a(k+" input#a_address").val(d),a(k+" input#b_address").val(f),"miles"===L?(a("input#"+l+"_radio_miles").prop("checked",!0),a("input#"+l+"_radio_km").prop("checked",!1)):"km"===L&&(a("input#"+
    l+"_radio_km").prop("checked",!0),a("input#"+l+"_radio_miles").prop("checked",!1)))});a(document).on("click",k+" div.d_close-wrapper",function(e){s(k);a(this).parent().fadeOut();H.setMap(null);b.html("");b.hide();a(k+" button#print_sub").hide();t();return!1})}function D(e,h,k){X.getPanoramaByLocation(e.position,50,function(b,d){if(d===google.maps.StreetViewStatus.OK)a(document).on("click","a#trigger-"+h.bubbleHolderId,function(){var b={navigationControl:!0,enableCloseButton:!0,addressControl:!1,linksControl:!0,
    scrollwheel:!1,addressControlOptions:{position:google.maps.ControlPosition.BOTTOM},position:e.position,pov:{heading:165,pitch:0,zoom:1}},c=new google.maps.StreetViewPanorama(document.getElementById("bubble-"+h.bubbleHolderId),b);c.setVisible(!0);google.maps.event.addListener(C,"closeclick",function(){s(k);a(k).fadeOut();null!=c&&(c.unbind("position"),c.setVisible(!1));c=null});google.maps.event.addListener(c,"closeclick",function(){null!=c&&(c.unbind("position"),c.setVisible(!1),a("div#bubble-"+h.bubbleHolderId).css("background",
    "none"));c=null})});else c.warn("There is not street view available for this marker location: "+e.position+" status: "+d),a(document).on("click","a#trigger-"+h.bubbleHolderId,function(a){a.preventDefault()}),a("a#trigger-"+h.bubbleHolderId).attr("style","text-decoration: none !important; color: #ddd !important"),google.maps.event.addListener(C,"domready",function(){a("a#trigger-"+h.bubbleHolderId).removeAttr("href");a("a#trigger-"+h.bubbleHolderId).attr("style","text-decoration: none !important; color: #ddd !important")})})}
    function P(){var e="div#direction-controls-placeholder-"+l,b=a("div#rendered-directions-placeholder-"+l);a(document).on("click",e+" a#reverse-btn",function(b){b=a(e+" input#a_address").val();var h=a(e+" input#b_address").val();a(e+" input#a_address").val(h);a(e+" input#b_address").val(b);return!1});a(document).on("click",e+" a#d_options_show",function(){a(e+" a#d_options_hide").show();a(e+" a#d_options_show").hide();a(e+" div#d_options").show();return!1});a(document).on("click",e+" a#d_options_hide",
        function(){a(e+" a#d_options_hide").hide();a(e+" a#d_options_show").show();a(e+" div#d_options").hide();a("input#"+l+"_avoid_hway").prop("checked",!1);a("input#"+l+"_avoid_tolls").prop("checked",!1);a("input#"+l+"_radio_km").prop("checked",!1);a("input#"+l+"_radio_miles").prop("checked",!0);return!1});a(document).on("click",e+" button#d_sub",function(){var k=a(e+" input#a_address").val(),d=a(e+" input#b_address").val(),f=!1;if(null==k||""==k)a(e+" input#a_address").addClass("d_error"),f=!0;if(null==
        d||""==d)a(e+" input#b_address").addClass("d_error"),f=!0;if(!f){a(e+" button#d_sub").prop("disabled",!0).html("Please wait..");var g=google.maps.DirectionsTravelMode.DRIVING;a(e+" a#dir_w_btn").hasClass("selected")&&(g=google.maps.DirectionsTravelMode.WALKING);var f=a("input#"+l+"_avoid_hway").is(":checked"),p=a("input#"+l+"_avoid_tolls").is(":checked"),m=a("input#"+l+"_radio_miles").is(":checked"),g={origin:k,destination:d,travelMode:g,provideRouteAlternatives:!0};f&&(g.avoidHighways=!0);p&&(g.avoidTolls=
        !0);g.unitSystem=m?google.maps.DirectionsUnitSystem.IMPERIAL:google.maps.DirectionsUnitSystem.METRIC;Y.route(g,function(f,g){g==google.maps.DirectionsStatus.OK?(b.html(""),b.show(),H.setMap(r),H.setDirections(f),a(e+" button#d_sub").removeAttr("disabled").html("Get directions"),a(e+" button#print_sub").fadeIn(),C.close()):(c.error('Could not route directions from "'+k+'" to "'+d+'", got result from Google: '+g),b.html("<span style='font-size: 12px; font-weight: bold; color: red'>Could not route directions from<br />'"+
        k+"' to<br />'"+d+"'<br />Got result from Google: ["+g+"]</span>"),a(e+" button#print_sub").hide(),a(e+" button#d_sub").removeAttr("disabled").html("Get directions"))})}});a(document).on("click",e+" button#print_sub",function(){var b=a(e+" input#a_address").val(),h=a(e+" input#b_address").val(),c="d";a(e+" a#dir_w_btn").hasClass("selected")&&(c="w");b="http://maps.google.com/?saddr="+b+"&daddr="+h+"&dirflg="+c+"&pw=2";b=a("input#"+l+"_radio_miles").is(":checked")?b+"&doflg=ptm":b+"&doflg=ptk";"d"===
        c&&(c=a("input#"+l+"_avoid_hway").is(":checked"),h=a("input#"+l+"_avoid_tolls").is(":checked"),c&&(b+="&dirflg=h"),h&&(b+="&dirflg=t"));window.open(b);return!1});a(document).on("change focus",e+" input#a_address",function(){a(e+" input#a_address").removeClass("d_error");return!1});a(document).on("change focus",e+" input#b_address",function(){a(e+" input#b_address").removeClass("d_error");return!1});a(document).on("click",e+" .kd-button",function(){var b=this.id;"dir_d_btn"==b?a(e+" a#dir_d_btn").hasClass("selected")?
        c.warn("Driving travel mode is already selected"):(a(e+" a#dir_d_btn").addClass("selected"),a(e+" a#dir_w_btn").removeClass("selected")):"dir_w_btn"==b&&(a(e+" a#dir_w_btn").hasClass("selected")?c.warn("Walking travel mode is already selected"):(a(e+" a#dir_w_btn").addClass("selected"),a(e+" a#dir_d_btn").removeClass("selected")));return!1})}function Z(a,b){var c=Math.floor(111111*Math.random()),c=c+"-"+l,d="<div id='bubble-"+c+"' style='height: 130px !important; width: 300px !important;' class='bubble-content'>";
        if(!b.geoMashup||b.geoMashup&&!b.infoBubbleContainPostLink)d+="<h4>"+CGMPGlobal.address+":</h4>",d+="<p class='custom-bubble-text'>"+a+"</p>",""!=b.customBubbleText&&(d+="<p class='custom-bubble-text'>"+b.customBubbleText+"</p>");else var f=b.postTitle.substring(0,30),d=d+""+("<p class='geo-mashup-post-title'><a title='Original post: "+b.postTitle+"' href='"+b.postLink+"'>"+f+"..</a></p>"),d=d+("<p class='geo-mashup-post-excerpt'>"+b.postExcerpt+"</p>");d+="<div class='custom-bubble-links-section'>";
        d+="<hr />";d+="<p class='custom-bubble-text'>"+CGMPGlobal.directions+": <a id='toHere-"+c+"' class='dirToHereTrigger' href='javascript:void(0);'>"+CGMPGlobal.toHere+"</a> - <a id='fromHere-"+c+"' class='dirFromHereTrigger' href='javascript:void(0);'>"+CGMPGlobal.fromHere+"</a> | <a id='trigger-"+c+"' class='streetViewTrigger' href='javascript:void(0);'>"+CGMPGlobal.streetView+"</a></p>";d+="</div></div>";return{bubbleHolderId:c,bubbleContent:d}}function m(a,b,c){var d={clickable:!1,cursor:"pointer",
        draggable:!1,flat:!0,icon:{url:CGMPGlobal.customMarkersUri+"gpsloc.png",size:new google.maps.Size(34,34),scaledSize:new google.maps.Size(17,17),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(8,8)},optimized:!1,position:new google.maps.LatLng(0,0),title:"Current location",zIndex:2};b&&(d=this.copyOptions_(d,b));b={clickable:!1,radius:0,strokeColor:"1bb6ff",strokeOpacity:0.4,fillColor:"61a0bf",fillOpacity:0.4,strokeWeight:1,zIndex:1};c&&(b=this.copyOptions_(b,c));this.marker_=new google.maps.Marker(d);
        this.circle_=new google.maps.Circle(b);this.map=this.position=this.accuracy=null;this.set("minimum_accuracy",null);this.set("position_options",{enableHighAccuracy:!0,maximumAge:1E3});this.circle_.bindTo("map",this.marker_);a&&this.setMap(a)}var w,E,L,T,J,S,r,I,W,B,K,M,l,U,z,C,X,H,Y,v=null,V=!1,Q=!1,R=[],F=[];m.prototype=new google.maps.MVCObject;m.prototype.set=function(a,b){if(/^(?:position|accuracy)$/i.test(a))throw"'"+a+"' is a read-only property.";/map/i.test(a)?this.setMap(b):google.maps.MVCObject.prototype.set.apply(this,
        arguments)};m.prototype.marker_=null;m.prototype.circle_=null;m.prototype.getMap=function(){return this.map};m.prototype.getPositionOptions=function(){return this.get("position_options")};m.prototype.setPositionOptions=function(a){this.set("position_options",a)};m.prototype.getPosition=function(){return this.position};m.prototype.getBounds=function(){return this.position?this.circle_.getBounds():null};m.prototype.getAccuracy=function(){return this.accuracy};m.prototype.getMinimumAccuracy=function(){return this.get("minimum_accuracy")};
    m.prototype.setMinimumAccuracy=function(a){this.set("minimum_accuracy",a)};m.prototype.watchId_=-1;m.prototype.setMap=function(a){this.map=a;this.notify("map");a?this.watchPosition_():(this.marker_.unbind("position"),this.circle_.unbind("center"),this.circle_.unbind("radius"),this.position=this.accuracy=null,navigator.geolocation.clearWatch(this.watchId_),this.watchId_=-1,this.marker_.setMap(a))};m.prototype.setMarkerOptions=function(a){this.marker_.setOptions(this.copyOptions_({},a))};m.prototype.setCircleOptions=
        function(a){this.circle_.setOptions(this.copyOptions_({},a))};m.prototype.updatePosition_=function(a){var b=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),d=null==this.marker_.getMap();if(d){if(null!=this.getMinimumAccuracy()&&a.coords.accuracy>this.getMinimumAccuracy())return;this.marker_.setMap(this.map);this.marker_.bindTo("position",this);this.circle_.bindTo("center",this,"position");this.circle_.bindTo("radius",this,"accuracy")}this.accuracy!=a.coords.accuracy&&google.maps.MVCObject.prototype.set.call(this,
        "accuracy",a.coords.accuracy);!d&&null!=this.position&&this.position.equals(b)||google.maps.MVCObject.prototype.set.call(this,"position",b)};m.prototype.watchPosition_=function(){var a=this;navigator.geolocation&&(this.watchId_=navigator.geolocation.watchPosition(function(b){a.updatePosition_(b)},function(b){google.maps.event.trigger(a,"geolocation_error",b)},this.getPositionOptions()))};m.prototype.copyOptions_=function(a,b){for(var d in b)!0!==m.DISALLOWED_OPTIONS[d]&&(a[d]=b[d]);return a};m.DISALLOWED_OPTIONS=
    {map:!0,position:!0,radius:!0};return{init:function(a,b,d,c){F=c;r=a;l=r.getDiv().id;W=b;L=d;google.maps.event.addListener(r,"click",function(){t()});w=[];E=[];M=5;B=K=I=J=null;T=S=!1;U=new google.maps.Geocoder;z=new google.maps.LatLngBounds;C=new google.maps.InfoWindow;X=new google.maps.StreetViewService;Y=new google.maps.DirectionsService;rendererOptions={draggable:!0};H=new google.maps.DirectionsRenderer(rendererOptions);H.setPanel(document.getElementById("rendered-directions-placeholder-"+l))},
        setGeoLocationIfEnabled:function(a){"true"===a&&(v=new m,google.maps.event.addListenerOnce(v,"position_changed",function(){r.setCenter(this.getPosition());r.fitBounds(this.getBounds())}),google.maps.event.addListener(v,"geolocation_error",function(a){alert("There was an error creating Geolocation marker: "+a.message+"\n\nProceeding with normal map generation..");c.error("There was an error obtaining your position. Message: "+a.message);v=null}),v.setPositionOptions({enableHighAccuracy:!0,timeout:6E3,
            maximumAge:0}),v.setMap(r))},buildAddressMarkers:function(a,c,f){T=!0;I=y.trim(a);I=y.searchReplace(I,"'","");"true"===c?(V=!0,a=q(I),"true"===f?d(a,!0):"false"===f&&d(a,!1)):null!=c&&"false"!==c||b(I,"","","",!1,!1);O();g()},isBuildAddressMarkersCalled:function(){return T}}},y=function(){return{isNumeric:function(a){return/^([0-9?(\-.,;\s{1,})]+)$/.test(a)},isAlphaNumeric:function(a){return/^([a-zA-Z0-9?(/\-.,\s{1,})]+)$/.test(a)},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},searchReplace:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           c,d){return a.replace(RegExp(c,"g"),d)}}}(),c=function(){var a=function(a){navigator.userAgent.match(/msie|trident/i)||console.log(a)};return{info:function(c){a("Info :: "+c)},raw:function(c){a(c)},warn:function(c){a("Warning :: "+c)},error:function(c){a("Error :: "+c)},fatal:function(c){a("Fatal :: "+c)}}}(),D=function(){return{alertError:function(c){function g(b,c){b.preventDefault();var d=a(c).closest("div.cgmp-popup-shortcode-dialog");d&&a(d).remove();0==a("div.cgmp-popup-shortcode-dialog").length&&
a("#cgmp-popup-mask").remove()}var d=a('<div id="cgmp-popup-mask"/>'),b=Math.random().toString(36).substring(3),f=a('<div id="'+b+'" class="cgmp-popup-shortcode-dialog cgmp-popup-window">');f.html("<div class='dismiss-container'><a class='dialog-dismiss' href='javascript:void(0)'>x</a></div><p style='text-align: left; padding: 10px 10px 0 10px'>"+c+"</p><div align='center'><input type='button' class='close-dialog' value='Close' /></div>");a("body").append(d);a("body").append(f);c=a(document).height();
    d=a(window).width();a("#cgmp-popup-mask").css({width:d,height:c,opacity:0.1});1==a("#cgmp-popup-mask").length&&a("#cgmp-popup-mask").show();c=a(window).height();d=a(window).width();a("div#"+b).css("top",c/2-a("div#"+b).height()/2);a("div#"+b).css("left",d/2-a("div#"+b).width()/2);a("div#"+b).fadeIn(500);a(".cgmp-popup-window .close-dialog").click(function(b){g(b,a(this))});a(".cgmp-popup-window .dialog-dismiss").click(function(b){g(b,a(this))});a("#cgmp-popup-mask").click(function(){a(this).remove();
        a(".cgmp-popup-window").remove()});a(window).resize(function(){var b=a(".window"),c=a(document).height(),d=a(window).width();a("#cgmp-popup-mask").css({width:d,height:c});c=a(window).height();d=a(window).width();b.css("top",c/2-b.height()/2);b.css("left",d/2-b.width()/2)})}}}(),s=document.head||document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("link");n.type="text/css";n.rel="stylesheet";n.href=CGMPGlobal.cssHref;n.media="screen";s.appendChild(n);s=parseFloat(a.fn.jquery.split(".")[0]);
    n=parseFloat(a.fn.jquery.split(".")[1]);(1>s||1<=s&&2>s&&9>n)&&c.fatal("Client uses jQuery older than the version 1.9.0, check if he is using jQuery Migrate plugin");if("undefined"===typeof google||!google)return D.alertError(CGMPGlobal.msgNoGoogle),c.fatal("We do not have reference to Google API. Aborting map generation .."),!1;if("undefined"!==typeof GMap2&&GMap2)return D.alertError(CGMPGlobal.msgApiV2),c.fatal("It looks like the webpage has reference to GMap2 object from Google API v2. Aborting map generation .."),
        !1;google.load("maps","3",{other_params:"sensor=false&libraries=panoramio&language="+CGMPGlobal.language,callback:function(){g()}})})("undefined"!==typeof g&&null!=g&&g?g:jQuery)}if("undefined"===typeof jQuery||null==jQuery){var n=!1,u=document.head||document.getElementsByTagName("head")[0]||document.documentElement,g=document.createElement("script");g.type="text/javascript";g.src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js";g.onload=g.onreadystatechange=function(){if(!n&&(!this.readyState||
    /loaded|complete/.test(g.readyState))){n=!0;var t=jQuery.noConflict();q(t);g.onload=g.onreadystatechange=null;u&&g.parentNode&&u.removeChild(g);g=void 0}};u.appendChild(g)}else q()})();
function base64_decode(q){var n,u,g,t,a,A=0,N=0;t="";var s=[];if(!q)return q;q+="";do n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(q.charAt(A++)),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(q.charAt(A++)),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(q.charAt(A++)),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(q.charAt(A++)),g=n<<18|u<<12|t<<6|a,n=g>>16&255,u=g>>8&255,
    g&=255,64==t?s[N++]=String.fromCharCode(n):64==a?s[N++]=String.fromCharCode(n,u):s[N++]=String.fromCharCode(n,u,g);while(A<q.length);return t=s.join("")};
